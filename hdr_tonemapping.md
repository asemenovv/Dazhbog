–î–∞ ‚Äî —ç—Ç–æ ¬´–ø–µ—Ä–µ—Å–≤–µ—Ç¬ª –∏–∑-–∑–∞ —Ç–æ–≥–æ, —á—Ç–æ —Ç—ã –≤—ã–≤–æ–¥–∏—à—å **–ª–∏–Ω–µ–π–Ω—É—é HDR-—è—Ä–∫–æ—Å—Ç—å** –Ω–∞–ø—Ä—è–º—É—é –≤ 8-–±–∏—Ç–Ω—ã–π —ç–∫—Ä–∞–Ω –±–µ–∑ —Ç–æ–Ω–º–∞–ø–ø–∏–Ω–≥–∞/–≥–∞–º–º—ã.  
–≠–º–∏—Å—Å–∏–≤–Ω—ã–π –º–∞—Ç–µ—Ä–∏–∞–ª –¥–∞—ë—Ç –∑–Ω–∞—á–µ–Ω–∏—è > 1, –≤—Å—ë –∫–ª–∏–ø–∞–µ—Ç—Å—è –≤ –±–µ–ª—ã–π.  
–†–µ—à–µ–Ω–∏–µ –≤ 3 —à–∞–≥–∞:

---

## 1Ô∏è‚É£ –ö–æ–ø–∏ HDR –≤ float, –º—ç–ø—å —Ç–æ–ª—å–∫–æ –ø–µ—Ä–µ–¥ –≤—ã–≤–æ–¥–æ–º
–•—Ä–∞–Ω–∏ –∞–∫–∫—É–º—É–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ü–≤–µ—Ç –ø–∏–∫—Å–µ–ª—è –≤ `glm::vec3` (float), –¥–µ–ª–∏ –Ω–∞ —á–∏—Å–ª–æ —Å—ç–º–ø–ª–æ–≤, **–Ω–µ –∫–ª–∞–º–ø–∏** –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∏.  
–ú—ç–ø–ø–∏–Ω–≥ –¥–µ–ª–∞–π –≤ –∫–æ–Ω—Ü–µ –∫–∞–¥—Ä–∞/—Å—ç–º–ø–ª–∞.

---

## 2Ô∏è‚É£ Exposure + Tone Mapping + Gamma
–î–æ–±–∞–≤—å —ç–∫—Å–ø–æ–∑–∏—Ü–∏—é, —Ç–æ–Ω–º–∞–ø–µ—Ä (–ª—É—á—à–µ **ACES**), –∑–∞—Ç–µ–º –≥–∞–º–º–∞ 2.2 (–∏–ª–∏ sRGB).

```cpp
// —ç–∫—Å–ø–æ–∑–∏—Ü–∏—è –≤ EV: +1 = √ó2, ‚àí1 = √ó0.5
inline glm::vec3 ApplyExposure(const glm::vec3& c, float exposureEV) {
    float k = std::exp2(exposureEV);
    return c * k;
}

// Narkowicz ACES (–±—ã—Å—Ç—Ä—ã–π –∏ –ø—Ä–∏—è—Ç–Ω—ã–π)
inline glm::vec3 TonemapACES(const glm::vec3& x) {
    const glm::vec3 a(2.51f), b(0.03f), c(2.43f), d(0.59f), e(0.14f);
    return glm::clamp((x * (a * x + b)) / (x * (c * x + d) + e), 0.0f, 1.0f);
}

inline glm::vec3 LinearToSRGB(const glm::vec3& c) {
    // –∞–ø–ø—Ä–æ–∫—Å. –≥–∞–º–º–∞ 2.2 (–º–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å —Ç–æ—á–Ω–æ–π sRGB –∫—Ä–∏–≤–æ–π)
    return glm::pow(glm::clamp(c, 0.0f, 1.0f), glm::vec3(1.0f / 2.2f));
}
```

–í –∫–æ–Ω—Ü–µ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ `perPixel`):

```cpp
glm::vec3 hdr = rayColor;             // –ª–∏–Ω–µ–π–Ω—ã–π HDR (–Ω–µ –∫–ª–∞–º–ø–∏—Ç—å!)
hdr = ApplyExposure(hdr, exposureEV); // –Ω–∞–ø—Ä–∏–º–µ—Ä, ‚àí1 ‚Ä¶ +2 EV
glm::vec3 ldr = TonemapACES(hdr);     // 0 ‚Ä¶ 1
glm::vec3 srgb = LinearToSRGB(ldr);
return { srgb, 1.0f };
```

---

## 3Ô∏è‚É£ –≠–º–∏—Å—Å–∏—è –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤ –ª–∏–Ω–µ–π–Ω–æ–º —Ü–≤–µ—Ç–µ
–¢–≤–æ–∏ –∑–Ω–∞—á–µ–Ω–∏—è `(1.0, 0.706, 0.422)` ‚Äî —ç—Ç–æ, —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ, **sRGB**.  
–î–ª—è —Ñ–∏–∑–∏—á–µ—Å–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —ç–Ω–µ—Ä–≥–∏–∏ –∏—Ö –Ω–∞–¥–æ –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –≤ –ª–∏–Ω–µ–π–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ:

```cpp
inline float SRGBToLinear(float u) {
    return (u <= 0.04045f) ? (u / 12.92f)
                           : std::pow((u + 0.055f) / 1.055f, 2.4f);
}
inline glm::vec3 SRGBToLinear(const glm::vec3& c) {
    return { SRGBToLinear(c.r), SRGBToLinear(c.g), SRGBToLinear(c.b) };
}

// –ø—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:
glm::vec3 warm_srgb   = { 1.0f, 0.706f, 0.422f };
glm::vec3 warm_linear = SRGBToLinear(warm_srgb);
const auto lightMat = m_Scene->Add(
    new DiffuseLightMaterial(warm_linear, 3.0f) // 3.0 = –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å
);
```

> –ï—Å–ª–∏ –æ—Å—Ç–∞–≤–∏—Ç—å sRGB –∫–∞–∫ –ª–∏–Ω–µ–π–Ω—ã–π, —Ç—ã ¬´–ø–µ—Ä–µ–Ω–∞–¥—É–≤–∞–µ—à—å¬ª —ç–Ω–µ—Ä–≥–∏—é ‚Äî –ø–µ—Ä–µ—Å–≤–µ—Ç —É—Å–∏–ª–∏–≤–∞–µ—Ç—Å—è.

---

## üí° –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ

- **–ü–æ–¥–±–æ—Ä —ç–∫—Å–ø–æ–∑–∏—Ü–∏–∏** ‚Äî –Ω–∞—á–Ω–∏ —Å `exposureEV = ‚àí1.0 ‚Ä¶ +1.0`.  
- **Fireflies** ‚Äî –¥–æ–±–∞–≤—å –º—è–≥–∫–∏–π clamp (—è—Ä–∫–æ—Å—Ç—å ‚â§ 3‚Äì5) –∏/–∏–ª–∏ next event estimation + MIS.  
- **–ò–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å** ‚Äî –¥—É–º–∞–π –æ–± —ç–º–∏—Å—Å–∏–∏ –∫–∞–∫ –æ *radiance per area*: —á–µ–º –º–µ–Ω—å—à–µ –ø–ª–æ—â–∞–¥—å ‚Äî —Ç–µ–º –≤—ã—à–µ —è—Ä–∫–æ—Å—Ç—å.  
- **–ö–ª–∞–º–ø–∏—Ç—å —Ü–≤–µ—Ç–∞** —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ —Ç–æ–Ω–º–∞–ø–∞.

---

–° —ç—Ç–∏–º–∏ –ø—Ä–∞–≤–∫–∞–º–∏ —Å–≤–µ—Ç –ª–∞–º–ø—ã –ø–µ—Ä–µ—Å—Ç–∞–Ω–µ—Ç –±—ã—Ç—å –±–µ–ª—ã–º –ø—è—Ç–Ω–æ–º:  
–≤ —Ö–∞–π–ª–∞–π—Ç–∞—Ö —Å–æ—Ö—Ä–∞–Ω–∏—Ç—Å—è —Ç—ë–ø–ª—ã–π –æ—Ç—Ç–µ–Ω–æ–∫, –∞ –æ–±—â–∞—è —Å—Ü–µ–Ω–∞ –±—É–¥–µ—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å—Å—è —ç–∫—Å–ø–æ–∑–∏—Ü–∏–µ–π.
